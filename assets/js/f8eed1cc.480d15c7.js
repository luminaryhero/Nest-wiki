"use strict";(self.webpackChunknest_wiki=self.webpackChunknest_wiki||[]).push([[942],{3859:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var t=s(1527),r=s(7540);const i={title:"\u6570\u636e\u5e93\u6a21\u5757(\u4e8c)"},o=void 0,l={permalink:"/nest-wiki/blog/02",source:"@site/blog/02.md",title:"\u6570\u636e\u5e93\u6a21\u5757(\u4e8c)",description:"- [x] \u6570\u636e\u5e93\u8fde\u63a5",date:"2023-12-28T14:26:58.000Z",formattedDate:"December 28, 2023",tags:[],readingTime:1.43,hasTruncateMarker:!1,authors:[],frontMatter:{title:"\u6570\u636e\u5e93\u6a21\u5757(\u4e8c)"},unlisted:!1,nextItem:{title:"\u914d\u7f6e\u6a21\u5757(\u4e09)",permalink:"/nest-wiki/blog/03"}},a={authorsImageUrls:[]},c=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u6570\u636e\u5e93\u6a21\u5757",id:"\u6570\u636e\u5e93\u6a21\u5757",level:2},{value:"User \u6a21\u5757",id:"user-\u6a21\u5757",level:2},{value:"\u6a21\u578b",id:"\u6a21\u578b",level:3},{value:"\u63a7\u5236\u5668",id:"\u63a7\u5236\u5668",level:3},{value:"\u670d\u52a1\u7c7b",id:"\u670d\u52a1\u7c7b",level:3}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",input:"input",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","\u6570\u636e\u5e93\u8fde\u63a5"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","\u6570\u636e\u64cd\u4f5c"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"$ pnpm add @nestjs/typeorm typeorm mysql2\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u6570\u636e\u5e93\u6a21\u5757",children:"\u6570\u636e\u5e93\u6a21\u5757"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"$ nest g mo databases\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"databases.module.ts"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Global, Module } from "@nestjs/common";\nimport { TypeOrmModule } from "@nestjs/typeorm";\n\n@Global()\n@Module({\n  imports: [\n    TypeOrmModule.forRoot({\n      type: "mysql",\n      host: "localhost",\n      port: 3306,\n      username: "root",\n      password: "12345678",\n      database: "test",\n      autoLoadEntities: true,\n      synchronize: true,\n    }),\n  ],\n})\nexport class DatabasesModule {}\n'})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"dtos/pagination.dto.ts"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export class PagintionDto {\n  limit?: number;\n\n  page?: number;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"user-\u6a21\u5757",children:"User \u6a21\u5757"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"@Module({\n  imports: [TypeOrmModule.forFeature([User])],\n  controllers: [UsersController],\n  providers: [UsersService],\n})\nexport class UsersModule {}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u6a21\u578b",children:"\u6a21\u578b"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"user.entity.ts"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Entity, Column, PrimaryGeneratedColumn } from "typeorm";\n\n@Entity()\nexport class User {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  username: string;\n\n  @Column()\n  password: string;\n\n  @Column({ default: true })\n  isActive: boolean;\n}\n'})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"create-user.dto.ts"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export class CreateUserDto {\n  username: string;\n\n  password: string;\n\n  isActive?: boolean;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u63a7\u5236\u5668",children:"\u63a7\u5236\u5668"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"users.controller.ts"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"@Get()\nfindAll(@Query() pagintionDto: PagintionDto) {\n  return this.usersService.findAll(pagintionDto);\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u670d\u52a1\u7c7b",children:"\u670d\u52a1\u7c7b"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"users.service.ts"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"@Injectable()\nexport class UsersService {\n  constructor(\n    @InjectRepository(User) private usersRepository: Repository<User>\n  ) {}\n\n  async create(createUserDto: CreateUserDto) {\n    const item = await this.usersRepository.save(createUserDto);\n    return item;\n  }\n\n  async findAll(pagintionDto: PagintionDto) {\n    const { limit = 10, page = 1 } = pagintionDto;\n    return this.usersRepository.find({\n      skip: (page - 1) * limit,\n      take: limit,\n    });\n  }\n\n  async findOne(id: number) {\n    const item = await this.usersRepository.findOne({ where: { id } });\n    if (!item) {\n      throw new EntityNotFoundError(User, { id });\n    }\n    return item;\n  }\n\n  async update(id: number, updateUserDto: UpdateUserDto) {\n    await this.usersRepository.update(id, updateUserDto);\n    return this.findOne(id);\n  }\n\n  async remove(id: number) {\n    const item = await this.findOne(id);\n    return this.usersRepository.remove(item);\n  }\n}\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},7540:(e,n,s)=>{s.d(n,{Z:()=>l,a:()=>o});var t=s(959);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);